-- Create {{.EntityPlural}} table
CREATE TABLE {{.EntityPlural}} (
    id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
    name VARCHAR(255) NOT NULL,
    description TEXT,
    {{if .IncludeS3}}image_key VARCHAR(512),{{end}}
    created_at TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP NOT NULL DEFAULT NOW()
);

-- Create indexes
CREATE INDEX idx_{{.EntityPlural}}_created_at ON {{.EntityPlural}}(created_at);
CREATE INDEX idx_{{.EntityPlural}}_name ON {{.EntityPlural}}(name);

-- Add updated_at trigger
CREATE TRIGGER set_timestamp
BEFORE UPDATE ON {{.EntityPlural}}
FOR EACH ROW
EXECUTE FUNCTION trigger_set_timestamp();